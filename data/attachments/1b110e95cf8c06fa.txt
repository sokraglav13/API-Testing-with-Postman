const Ajv = require('ajv');
const ajv = new Ajv();

const schema = {
    type: "array",
    items: {
    type: "object",
    properties: {
      albumId: { type: "integer" },
      id: { type: "integer" },
      title: { type: "string" },
      url: { type: "string" },
      tthumbnailUrl: { type: "string" }
    },
    required: ["albumId", "id", "title", "url", "thumbnailUrl"]
    }
};

const responseJson = pm.response.json();

const validate = ajv.compile(schema);
const valid = validate(responseJson);

pm.test("Check response schema is valid", function() {
  pm.expect(valid).to.be.true;

  if (!valid) {
    console.log(validate.errors); // Log validation errors if schema is invalid
  }
});
pm.test("Check response status code is 200", function () {
    pm.response.to.have.status(200);
});
pm.test("Check response status code name has string", function () {
    pm.response.to.have.status("OK");
});
pm.test("Check response time is less than 700ms", function () {
    pm.expect(pm.response.responseTime).to.be.below(700);
});
pm.test("Check request headers", function () {
    pm.response.to.have.header("Content-Type");
});
pm.test("Check photo with if value = 1 properties value", function () {
    const expectedResponse = {
        "albumId": 1,
        "id": 1,
        "title": "accusamus beatae ad facilis cum similique qui sunt",
        "url": "https://via.placeholder.com/600/92c952",
        "thumbnailUrl": "https://via.placeholder.com/150/92c952"
    };
    var jsonData = pm.response.json();
    pm.expect(jsonData[0].albumId).eql(expectedResponse.albumId)
    pm.expect(jsonData[0].id).eql(expectedResponse.id)
    pm.expect(jsonData[0].title).eql(expectedResponse.title)
    pm.expect(jsonData[0].url).eql(expectedResponse.url)
    pm.expect(jsonData[0].thumbnailUrl).eql(expectedResponse.thumbnailUrl)

});